// See https://aka.ms/new-console-template for more information

using Benchmarking;
using System.Data;
using System.Data.OleDb;

string connectionString = @"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\work\OM\IClearing\Main\Source\IClearingWeb\ExcelTemplates\Auftraege.xls;Extended Properties='Excel 8.0;HDR=YES;'";

using (OleDbConnection connection = new OleDbConnection(connectionString))
{
    try
    {
        connection.Open();

        ExcelHelper excelHelper = new ExcelHelper(connection);
        string[] memoColumns = { "Anfallstelle", "Bemerkungen" };

        var sb = "'1', '2', '3','33','4','5','6','7','8','9','99','999', 'ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890ABCDEFGHIJKLMNOPQRTUVXYZ1234567890'";

        using (OleDbCommand dbCommand = connection.CreateCommand())
        {
            excelHelper.PrepareWorksheet("Tabelle1", memoColumns);

            var sqlCommandQuery = "INSERT INTO [Tabelle1$] VALUES (" + sb + ")";

            dbCommand.CommandText = sqlCommandQuery;
            dbCommand.CommandType = CommandType.Text;

            // Execute the command
            int rowsAffected = dbCommand.ExecuteNonQuery();

            Console.WriteLine($"{rowsAffected} row(s) inserted.");
        }
    }

    catch (Exception ex)
    {
        Console.WriteLine("Error: " + ex.Message);
    }
}